geom_point(shape = 1) +
geom_smooth(method = "lm", se = FALSE, color = "black") +
xlab("Year") + ylab(expression(paste("(Imm Focus)"[ij] - bar("(Imm Focus)")[j]))) +
facet_wrap(~org, labeller = label_wrap_gen(width = 50)) +
xlim(1980, 2008) +
theme_bw() +
theme(strip.text = element_text(size = 2))
png("figures/ugm.png", res = 750, height = 6, width = 8, units = "in")
ugm
dev.off()
ugm <- wno_data %>%
filter(complete.cases(.)) %>%
group_by(org) %>%
mutate(imm_y = immigration - mean(immigration)) %>%
ungroup() %>%
ggplot(aes(x = year, y = imm_y)) +
geom_point(shape = 1) +
geom_smooth(method = "lm", se = FALSE, color = "black") +
xlab("Year") + ylab(expression(paste("(Imm Focus)"[ij] - bar("(Imm Focus)")[j]))) +
facet_wrap(~org, labeller = label_wrap_gen(width = 50)) +
xlim(1980, 2008) +
theme_bw() +
theme(strip.text = element_text(size = 6))
png("figures/ugm.png", res = 750, height = 10, width = 8, units = "in")
ugm
dev.off()
ugm <- wno_data %>%
filter(complete.cases(.)) %>%
group_by(org) %>%
mutate(imm_y = immigration - mean(immigration)) %>%
ungroup() %>%
ggplot(aes(x = year, y = imm_y)) +
geom_point(shape = 1) +
geom_smooth(method = "lm", se = FALSE, color = "black") +
xlab("Year") + ylab(expression(paste("(Imm Focus)"[ij] - bar("(Imm Focus)")[j]))) +
facet_wrap(~org, labeller = label_wrap_gen(width = 50)) +
xlim(1980, 2008) +
theme_bw() +
theme(strip.text = element_text(size = 6))
png("figures/ugm.png", res = 750, height = 6, width = 10, units = "in")
ugm
dev.off()
ugm <- wno_data %>%
filter(complete.cases(.)) %>%
group_by(org) %>%
mutate(imm_y = immigration - mean(immigration)) %>%
ungroup() %>%
ggplot(aes(x = year, y = imm_y)) +
geom_point(shape = 1) +
geom_smooth(method = "lm", se = FALSE, color = "black") +
xlab("Year") + ylab(expression(paste("(Imm Focus)"[ij] - bar("(Imm Focus)")[j]))) +
facet_wrap(~org, labeller = label_wrap_gen(width = 50)) +
xlim(1980, 2008) +
theme_bw() +
theme(strip.text = element_text(size = 6))
png("figures/ugm.png", res = 750, height = 10, width = 12, units = "in")
ugm
dev.off()
ugm <- wno_data %>%
filter(complete.cases(.)) %>%
group_by(org) %>%
mutate(imm_y = immigration - mean(immigration)) %>%
ungroup() %>%
ggplot(aes(x = year, y = imm_y)) +
geom_point(shape = 1) +
geom_smooth(method = "lm", se = FALSE, color = "black") +
xlab("Year") + ylab(expression(paste("(Imm Focus)"[ij] - bar("(Imm Focus)")[j]))) +
facet_wrap(~org, labeller = label_wrap_gen(width = 50)) +
xlim(1980, 2008) +
theme_bw() +
theme(strip.text = element_text(size = 6))
png("figures/ugm.png", res = 750, height = 10, width = 13, units = "in")
ugm
dev.off()
mat
mat2
mat3
mat3 <- perm_tester(data = wno_data, model = model3,
perm_var = "immigration", statistic = "coefficients",
strat_var = "org", seed = 123)
mat3
model.data3 <- as.data.frame(model3$model)
model.data3 <- model.data3 %>%
rename(admin = `factor.admin.`,
reform = `factor.reform.`)
labs2 <- c("Pre-9/11","Post-9/11")
names(labs2) <- c("0","1")
fig7 <- predictions(model3, variables = list(log_terror = seq(quantile(wno_data$log_terror, .25, na.rm = T),
quantile(wno_data$log_terror, .75, na.rm = T),
by = .25),
log_hisppop = c(quantile(wno_data$log_hisppop, .25, na.rm = T),
quantile(wno_data$log_hisppop, .5, na.rm = T),
quantile(wno_data$log_hisppop, .75, na.rm = T)),
p2001 = c(0,1)),
newdata = model.data3) %>%
mutate(log_terror = (exp(log_terror)-1),
log_hisppop = exp(log_hisppop),
p2001 = as.factor(p2001)) %>%
select(rowid, predicted, log_hisppop, log_terror, p2001) %>%
mutate(predicted = (exp(predicted)/(1 + exp(predicted)))) %>%
group_by(log_hisppop, log_terror, p2001) %>%
summarise(predicted_sum = mean(predicted)) %>%
ggplot(aes(x = log_terror, y = predicted_sum,
linetype = as.factor(log_hisppop),
group = interaction(p2001, as.factor(log_hisppop)),
color = p2001)) +
geom_line() +
labs(y = '"Borders and Immigration" Grievance Probability',
x = "Number of Non-Right Wing Terror Threats or Attacks in U.S. in Previous Year",
color = "", linetype = "") +
scale_linetype_discrete(#breaks = c(-1,0,1),
labels = c(expression("25"^{th}~"Percentile Hispanic Population in County"),
"Median Hispanic Population in County",
expression("75"^{th}~"Percentile Hispanic Population in County")),
name = "") +
scale_color_manual(breaks = c(0,1),
values = c("#1696d2","#fdbf11"),
labels = c("Before/Including 2001","Post-2001")) +
theme_bw() +
theme(axis.title = element_text(face = "bold"),
legend.position = "top",
legend.box = "vertical",
legend.direction = "horizontal")
fig7
png("figures/fig7.png", res = 750, height = 6, width =8, units = "in")
fig7
dev.off()
vd.re$vcov[2]/(vd.re$vcov[1] + vd.re$vcov[2]) #1 - ICC
colnames(wno_data)
model <- plm(immigration ~ log_terror*log_hisppop*construal_style + discursive_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within")
mat <- perm_tester(data = wno_data, model = model,
perm_var = "immigration", statistic = "coefficients",
strat_var = "org", seed = 123)
mat
model <- plm(immigration ~ log_terror*construal_style + discursive_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within")
mat <- perm_tester(data = wno_data, model = model,
perm_var = "immigration", statistic = "coefficients",
strat_var = "org", seed = 123)
mat
model.data <- as.data.frame(model$model)
model.data <- model.data %>%
rename(admin = `factor.admin.`,
reform = `factor.reform.`)
concreteness
concreteness[sort(concrete_mean),]
concreteness[sort(concreteness$concrete_mean),]
concreteness[order(concreteness$concrete_mean),]
predictions(model, variables = list(log_terror = seq(quantile(wno_data$log_terror, .25, na.rm = T),
quantile(wno_data$log_terror, .75, na.rm = T),
by = .25),
construal_style = c(quantile(wno_data$construal_style, .25, na.rm = T),
quantile(wno_data$construal_style, .5, na.rm = T),
quantile(wno_data$construal_style, .75, na.rm = T))),
newdata = model.data) %>%
mutate(log_terror = (exp(log_terror)-1)) %>%
# mutate(p2001 = NA) %>%
# rbind(.,
#       predictions(model2, variables = list(sd_construal = seq(-1,1, by  = 1),
#                                            sd_log_terror = seq(-2,2, by = .5),
#                                            p2001 = c(0,1)),
#                   newdata = model.data2) %>%
# # mutate(model_id = c(rep("model", 1650), rep("model2", (tally(.) - 1650)))) %>%
select(rowid, predicted, construal_style, log_terror) %>%
mutate(predicted = (exp(predicted)/(1 + exp(predicted)))) %>%
group_by(construal_style, log_terror) %>%
summarise(predicted_sum = mean(predicted)) %>%
ggplot(aes(x = log_terror, y = predicted_sum, linetype = as.factor(construal_style))) +
geom_line() +
labs(y = '"Borders and Immigration" Grievance Probability',
x = "Number of Non-Right Wing Terror Threats or Attacks in U.S. in Previous Year") +
# scale_x_continuous(trans = scales::log_trans()) +
# coord_trans(x = "log") +
scale_linetype_discrete(#breaks = c(-1,0,1),
labels = c(expression("25"^{th}~"Percentile Construal Style at 25"^{th}~"Percentile (Abstract)"),
"Median Construal Style",
expression("25"^{th}~"Percentile Construal Style at 25"^{th}~"Percentile (Concrete)")),
name = "") +
theme_bw() +
theme(axis.title = element_text(face = "bold"),
legend.position = "top")
predictions(model, variables = list(log_terror = seq(quantile(wno_data$log_terror, .25, na.rm = T),
quantile(wno_data$log_terror, .75, na.rm = T),
by = .25),
construal_style = c(quantile(wno_data$construal_style, .25, na.rm = T),
quantile(wno_data$construal_style, .5, na.rm = T),
quantile(wno_data$construal_style, .75, na.rm = T))),
newdata = model.data) %>%
mutate(log_terror = (exp(log_terror)-1)) %>%
# mutate(p2001 = NA) %>%
# rbind(.,
#       predictions(model2, variables = list(sd_construal = seq(-1,1, by  = 1),
#                                            sd_log_terror = seq(-2,2, by = .5),
#                                            p2001 = c(0,1)),
#                   newdata = model.data2) %>%
# # mutate(model_id = c(rep("model", 1650), rep("model2", (tally(.) - 1650)))) %>%
select(rowid, predicted, construal_style, log_terror) %>%
mutate(predicted = (exp(predicted)/(1 + exp(predicted)))) %>%
group_by(construal_style, log_terror) %>%
summarise(predicted_sum = mean(predicted)) %>%
ggplot(aes(x = log_terror, y = predicted_sum, linetype = as.factor(construal_style))) +
geom_line() +
labs(y = '"Borders and Immigration" Grievance Probability',
x = "Number of Non-Right Wing Terror Threats or Attacks in U.S. in Previous Year") +
# scale_x_continuous(trans = scales::log_trans()) +
# coord_trans(x = "log") +
scale_linetype_discrete(#breaks = c(-1,0,1),
labels = c(expression("25"^{th}~"Percentile Construal Style at 25"^{th}~"Percentile (Abstract)"),
"Median Construal Style",
expression("75"^{th}~"Percentile Construal Style at 25"^{th}~"Percentile (Concrete)")),
name = "") +
theme_bw() +
theme(axis.title = element_text(face = "bold"),
legend.position = "top")
predictions(model, variables = list(log_terror = seq(quantile(wno_data$log_terror, .25, na.rm = T),
quantile(wno_data$log_terror, .75, na.rm = T),
by = .25),
construal_style = c(quantile(wno_data$construal_style, .25, na.rm = T),
quantile(wno_data$construal_style, .5, na.rm = T),
quantile(wno_data$construal_style, .75, na.rm = T))),
newdata = model.data) %>%
mutate(log_terror = (exp(log_terror)-1)) %>%
# mutate(p2001 = NA) %>%
# rbind(.,
#       predictions(model2, variables = list(sd_construal = seq(-1,1, by  = 1),
#                                            sd_log_terror = seq(-2,2, by = .5),
#                                            p2001 = c(0,1)),
#                   newdata = model.data2) %>%
# # mutate(model_id = c(rep("model", 1650), rep("model2", (tally(.) - 1650)))) %>%
select(rowid, predicted, construal_style, log_terror) %>%
mutate(predicted = (exp(predicted)/(1 + exp(predicted)))) %>%
group_by(construal_style, log_terror) %>%
summarise(predicted_sum = mean(predicted)) %>%
ggplot(aes(x = log_terror, y = predicted_sum, linetype = as.factor(construal_style))) +
geom_line() +
labs(y = '"Borders and Immigration" Grievance Probability',
x = "Number of Non-Right Wing Terror Threats or Attacks in U.S. in Previous Year") +
# scale_x_continuous(trans = scales::log_trans()) +
# coord_trans(x = "log") +
scale_linetype_discrete(#breaks = c(-1,0,1),
labels = c(expression("Construal Style at 25"^{th}~"Percentile (Abstract)"),
"Median Construal Style",
expression("Construal Style at 25"^{th}~"Percentile (Concrete)")),
name = "") +
theme_bw() +
theme(axis.title = element_text(face = "bold"),
legend.position = "top")
wn.stm
sageLabels(wn.stm)
temp <- sageLabels(wn.stm)
temp$marginal
temp <- sageLabels(wn.stm, n = 15)
temp
temp <- sageLabels(wn.stm, n = 30)
temp$marginal$prob[,2]
temp$marginal$prob
temp$marginal$prob[2,]
temp <- temp$marginal$prob[2,]
temp.terms <- filter(concreteness, term %in% temp)
temp.terms
temp.terms %>% mean(concrete_mean)
View(temp.terms)
mean(temp.terms%concrete_mean)
mean(temp.terms$concrete_mean)
quantile(temp.terms$concrete_mean, p = .5)
model <- plm(immigration ~ log_hisppop*construal_style + discursive_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within")
mat <- perm_tester(data = wno_data, model = model,
perm_var = "immigration", statistic = "coefficients",
strat_var = "org", seed = 123)
mat
plm(immigration ~ log_hisppop*construal_style + discursive_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within") %>% summary()
cor(wno_data$immigration, wno_data$construal_style)
cor(wno_data$immigration, wno_data$construal_style, use = "complete.obs")
cor(wno_data[,c("immigration","construal_style","discursive_style"), use = "complete.obs")
cor(wno_data[,c("immigration","construal_style","discursive_style")], use = "complete.obs")
plm(immigration ~ log_hisp*construal_style + discursive_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within") %>% summary()
plm(immigration ~ hisp_interpop*construal_style + discursive_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within") %>% summary()
plm(immigration ~ hisp_interprop*construal_style + discursive_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within") %>% summary()
model <- plm(immigration ~ hisp_interprop*construal_style + discursive_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within")
mat <- perm_tester(data = wno_data, model = model,
perm_var = "immigration", statistic = "coefficients",
strat_var = "org", seed = 123)
mat
plm(immigration ~ log_hispop*construal_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within") %>% summary()
plm(immigration ~ log_hisppop*construal_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within") %>% summary()
plm(immigration ~ log_hisppop + construal_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within") %>% summary()
plm(immigration ~ log_hisppop*construal_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within") %>% summary()
psych::describe(wno_data$construal_style)
plm(immigration ~ log_terror*construal_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within") %>% summary()
model <- plm(immigration ~ log_hisppop*construal_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within") %>% summary()
predictions(model, variables = list(log_hisppop = seq(quantile(wno_data$log_hisppop, .25, na.rm = T),
quantile(wno_data$log_hisppop, .75, na.rm = T),
by = .25),
construal_style = c(quantile(wno_data$construal_style, .25, na.rm = T),
quantile(wno_data$construal_style, .5, na.rm = T),
quantile(wno_data$construal_style, .75, na.rm = T))),
newdata = model.data) %>%
mutate(log_hisppop = (exp(log_hisppop))) %>%
# mutate(p2001 = NA) %>%
# rbind(.,
#       predictions(model2, variables = list(sd_construal = seq(-1,1, by  = 1),
#                                            sd_log_terror = seq(-2,2, by = .5),
#                                            p2001 = c(0,1)),
#                   newdata = model.data2) %>%
# # mutate(model_id = c(rep("model", 1650), rep("model2", (tally(.) - 1650)))) %>%
select(rowid, predicted, construal_style, log_hisppop) %>%
mutate(predicted = (exp(predicted)/(1 + exp(predicted)))) %>%
group_by(construal_style, log_hisppop) %>%
summarise(predicted_sum = mean(predicted)) %>%
ggplot(aes(x = log_hisppop, y = predicted_sum, linetype = as.factor(construal_style))) +
geom_line() +
labs(y = '"Borders and Immigration" Grievance Probability',
x = "Number of Non-Right Wing Terror Threats or Attacks in U.S. in Previous Year") +
# scale_x_continuous(trans = scales::log_trans()) +
# coord_trans(x = "log") +
scale_linetype_discrete(#breaks = c(-1,0,1),
labels = c(expression("Construal Style at 25"^{th}~"Percentile (Abstract)"),
"Median Construal Style",
expression("Construal Style at 25"^{th}~"Percentile (Concrete)")),
name = "") +
theme_bw() +
theme(axis.title = element_text(face = "bold"),
legend.position = "top")
model.data <- as.data.frame(model$model)
model.data <- model.data %>%
rename(admin = `factor.admin.`,
reform = `factor.reform.`)
predictions(model, variables = list(log_hisppop = seq(quantile(wno_data$log_hisppop, .25, na.rm = T),
quantile(wno_data$log_hisppop, .75, na.rm = T),
by = .25),
construal_style = c(quantile(wno_data$construal_style, .25, na.rm = T),
quantile(wno_data$construal_style, .5, na.rm = T),
quantile(wno_data$construal_style, .75, na.rm = T))),
newdata = model.data) %>%
mutate(log_hisppop = (exp(log_hisppop))) %>%
# mutate(p2001 = NA) %>%
# rbind(.,
#       predictions(model2, variables = list(sd_construal = seq(-1,1, by  = 1),
#                                            sd_log_terror = seq(-2,2, by = .5),
#                                            p2001 = c(0,1)),
#                   newdata = model.data2) %>%
# # mutate(model_id = c(rep("model", 1650), rep("model2", (tally(.) - 1650)))) %>%
select(rowid, predicted, construal_style, log_hisppop) %>%
mutate(predicted = (exp(predicted)/(1 + exp(predicted)))) %>%
group_by(construal_style, log_hisppop) %>%
summarise(predicted_sum = mean(predicted)) %>%
ggplot(aes(x = log_hisppop, y = predicted_sum, linetype = as.factor(construal_style))) +
geom_line() +
labs(y = '"Borders and Immigration" Grievance Probability',
x = "Number of Non-Right Wing Terror Threats or Attacks in U.S. in Previous Year") +
# scale_x_continuous(trans = scales::log_trans()) +
# coord_trans(x = "log") +
scale_linetype_discrete(#breaks = c(-1,0,1),
labels = c(expression("Construal Style at 25"^{th}~"Percentile (Abstract)"),
"Median Construal Style",
expression("Construal Style at 25"^{th}~"Percentile (Concrete)")),
name = "") +
theme_bw() +
theme(axis.title = element_text(face = "bold"),
legend.position = "top")
model.data
model <- plm(immigration ~ log_hisppop*construal_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within")
model.data <- as.data.frame(model$model)
model.data <- model.data %>%
rename(admin = `factor.admin.`,
reform = `factor.reform.`)
predictions(model, variables = list(log_hisppop = seq(quantile(wno_data$log_hisppop, .25, na.rm = T),
quantile(wno_data$log_hisppop, .75, na.rm = T),
by = .25),
construal_style = c(quantile(wno_data$construal_style, .25, na.rm = T),
quantile(wno_data$construal_style, .5, na.rm = T),
quantile(wno_data$construal_style, .75, na.rm = T))),
newdata = model.data) %>%
mutate(log_hisppop = (exp(log_hisppop))) %>%
# mutate(p2001 = NA) %>%
# rbind(.,
#       predictions(model2, variables = list(sd_construal = seq(-1,1, by  = 1),
#                                            sd_log_terror = seq(-2,2, by = .5),
#                                            p2001 = c(0,1)),
#                   newdata = model.data2) %>%
# # mutate(model_id = c(rep("model", 1650), rep("model2", (tally(.) - 1650)))) %>%
select(rowid, predicted, construal_style, log_hisppop) %>%
mutate(predicted = (exp(predicted)/(1 + exp(predicted)))) %>%
group_by(construal_style, log_hisppop) %>%
summarise(predicted_sum = mean(predicted)) %>%
ggplot(aes(x = log_hisppop, y = predicted_sum, linetype = as.factor(construal_style))) +
geom_line() +
labs(y = '"Borders and Immigration" Grievance Probability',
x = "Number of Non-Right Wing Terror Threats or Attacks in U.S. in Previous Year") +
# scale_x_continuous(trans = scales::log_trans()) +
# coord_trans(x = "log") +
scale_linetype_discrete(#breaks = c(-1,0,1),
labels = c(expression("Construal Style at 25"^{th}~"Percentile (Abstract)"),
"Median Construal Style",
expression("Construal Style at 25"^{th}~"Percentile (Concrete)")),
name = "") +
theme_bw() +
theme(axis.title = element_text(face = "bold"),
legend.position = "top")
model <- plm(immigration ~ log_terror*log_hisppop +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within")
mat <- perm_tester(data = wno_data, model = model,
perm_var = "immigration", statistic = "coefficients",
strat_var = "org", seed = 123)
mat
plm(immigration ~ log_terror*log_hisppop +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within")
plm(immigration ~ log_terror*log_hisppop +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within") %>% summary()
model <- plm(immigration ~ log_terror*log_hisppop + discursive_style +
per_repub + vcrime_rate + factor(reform) + p2001 + log_vocality +
word_count + factor(admin),
data = wno_data,
index = c("org","year"),
model = "within")
mat <- perm_tester(data = wno_data, model = model,
perm_var = "immigration", statistic = "coefficients",
strat_var = "org", seed = 123)
mat
citation("udpipe")
?removeSparseTerms
dtm
rowSums(dtm) |> sum()
rowSums(dtm)
rowSums(as.matrix(dtm))
rowSums(as.matrix(dtm)) |> sum()
